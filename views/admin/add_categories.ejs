<%-include('../partials/admin_header')%>

<!-- topbar -->
<div class="container-fluid" style="background-color: rgb(255, 255, 255); height: 100px;">
  <div class="row mt-1">
      <h3 class="content-title card-title mt-3" style="color: #00000098; text-align: center;">ADD CATEGORIES</h3>
      <p style="color: rgba(0, 0, 0, 0.493); text-align: center;">( ADD / EDIT / DELETE CATEGORY)</p>
      <hr>
  </div>
</div>
  <!-- /topbar -->

<section class="content-main">
  <div class="card">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
          <form action="/admin/add_categories" method="post">
            <div class="mb-4">
              <label class="form-label">Name</label>
              <input
                type="text"
                placeholder="Name"
                id="name"
                class="form-control"
                name="Name"
                required
              />
            </div>

            <div class="mb-4">
              <label class="form-label">Description</label>
              <textarea
                placeholder="Description"
                id="description"
                name="Description"
                class="form-control"
                required
              ></textarea>
            </div>
            <div class="d-grid">
              <button style="background-color: rgba(253, 253, 253, 0.712);" class="btn btn-primary" id="btn" type="submit">
                CREATE CATEGORY
              </button>
            </div>
          </form>
        </div>
        <div class="col-md-9">
          <div class="table-responsive">
            <table class="table table-hover display mt-4">
              <thead>
                <tr>
                    <div class="form-check">     
                  <th scope="col">ID</th>
                  <th scope="col">Name</th>
                  <th scope="col">Description</th>
                  <th scope="col" class="text-center" colspan="2">Actions</th>
                     </div>
                </tr>
                <tbody>
                  <% viewCategory.forEach(function(viewCategory,index){ %>
                    <tr>
                      <td><%= index+1  %></td>    
                      <td><%= viewCategory.categoryName %></td>
                      <td><%= viewCategory.description %></td>
                      <td>
                        <div class="text-center">
                          <a href="/admin/edit_category/<%= viewCategory._id%>"style="background-color: rgba(253, 253, 253, 0.712);" class="btn btn-xs btn-success "><p style="color: green;">Edit</p></a>   
                          <a href="/admin/delete_category/<%= viewCategory._id%>"style="background-color: rgba(253, 253, 253, 0.712);" class="btn btn-xs btn-danger" onclick="return deleteConfirmation(event)"><p style="color: red;">Delete</p></a>
                         </div>
                      </td>
                    </tr>
                    <% })%>
                </tbody>
              </thead>
            </table>
          </div>
        </div>
        <!-- .col// -->
      </div>
      <!-- .row // -->
    </div>
    <!-- card body .// -->
  </div>
  <!-- card .// -->
</section>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
  function deleteConfirmation(event) {
    event.preventDefault(); // Prevent the default link behavior
    
    // Display the SweetAlert confirmation dialog
    swal({
      title: "Are you sure?",
      text: "Once deleted, you will not be able to recover this category!",
      icon: "warning",
      buttons: true,
      dangerMode: true,
    })
    .then((willDelete) => {
      if (willDelete) {
        // If the user confirms the deletion, proceed with the link navigation
        window.location.href = event.target.href;
      }
    });
  }

</script>

<script>
  document.getElementById("btn").onclick = () => {
    let name = document.getElementById("name").value;
    document.getElementById("name").value = name.trim();

    let des = document.getElementById("des").value;
    document.getElementById("des").value = des.trim();
  };
</script>
<script>
  function hide(id) {
    setTimeout(() => {
      document.getElementById(id).style.display = "none";
    }, 1300);
  }

  hide("alert");
</script>

<%-include('../partials/admin_footer')%>
