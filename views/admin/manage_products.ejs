<%-include('../partials/admin_header')%>

<section>
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-md-12">
        <div class="table-responsive">
          <table class="table table-hover mt-4">
            <thead>
              <tr>
                <th scope="col">No</th>
                <th scope="col">Name</th>
                <th scope="col">Category</th>
                <th scope="col">Description</th>
                <th scope="col">Price</th>
                <th scope="col">Images</th>
                <th scope="col">Status</th>
                <th scope="col" class="text-center" colspan="3">Actions</th>
              </tr>
            </thead>
            <tbody>
              <% viewProduct.forEach(function(viewProducts,index){ %>
                <tr>
                  <td><%= index+1  %></td>    
                  <td><%= viewProducts.productName %></td>
                  <td><%= viewProducts.category %></td>
                  <td><%= viewProducts.description %></td>
                  <td><%= viewProducts.price %></td>
                  <td>
                    <div class="d-flex justify-content-center align-items-center  rounded" style="width: 50px; height: 50px; overflow: hidden;">
                      <img src="/uploads/products/<%= viewProducts.image[1]%>" class="img-fluid " alt="Product image">
                    </div>
                  </td>
                  <td>
                    <% if (viewProducts.block == true) { %>
                     <p style="color: red;">Inactive</p>
                    <% }else { %>
                      <p style="color: green;">Active</p>
                    <% }  %>
                     
                  </td>
                  <td class="text-center">
                    <a href="/admin/edit_product/<%= viewProducts._id %>" class="btn btn-xs btn-success">Edit</a>   
                    <a href="/admin/delete_product/<%= viewProducts._id%>" class="btn btn-xs btn-danger" onclick="return deleteConfirmation(event)">Delete</a>
                    <% if (viewProducts.block == true) { %>
                      <a href="/admin/soft_undelete/<%= viewProducts._id%>" class="btn btn-xs btn-danger" onclick="return activeAlert(event)">Active</a>
                    <% }else { %>
                      <a href="/admin/soft_delete/<%= viewProducts._id%>" class="btn btn-xs btn-danger" onclick="return inactiveAlert(event)">Inactive</a>
                    <% }  %>   
                  </td>
                </tr>
              <% })%>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>

<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
  function deleteConfirmation(event) {
    event.preventDefault(); // Prevent the default link behavior
    
    // Display the SweetAlert confirmation dialog
    swal({
      title: "Are you sure?",
      text: "Once deleted, you will not be able to recover this product!",
      icon: "warning",
      buttons: true,
      dangerMode: true,
    })
    .then((willDelete) => {
      if (willDelete) {
        // If the user confirms the deletion, proceed with the link navigation
        window.location.href = event.target.href;
      }
    });
  }
  function activeAlert(event) {
    event.preventDefault(); // Prevent the default link behavior

    // Fetch the image URL
    // Replace `imageUrl` with the actual URL of the image
    const imageUrl = "https://example.com/path/to/product-image.jpg";

    // Display the SweetAlert question dialog
    swal({
      title: "Are you sure?",
      text: "Do you want to activate this product?",
      icon: "warning",
      buttons: ["No", "Yes"], // Use buttons array for the question dialog
    })
    .then((isConfirmed) => {
      if (isConfirmed) {
        // If the user confirms the activation, proceed with the link navigation
        window.location.href = event.target.href;

        // Set the image source dynamically
        document.getElementById("productImage").src = imageUrl;
      }
    });
  }
  function inactiveAlert(event) {
    event.preventDefault(); // Prevent the default link behavior

    // Fetch the image URL
    // Replace `imageUrl` with the actual URL of the image
    const imageUrl = "https://example.com/path/to/product-image.jpg";

    // Display the SweetAlert question dialog
    swal({
      title: "Are you sure?",
      text: "Do you want to Inactivate this product?",
      icon: "warning",
      buttons: ["No", "Yes"], // Use buttons array for the question dialog
    })
    .then((isConfirmed) => {
      if (isConfirmed) {
        // If the user confirms the activation, proceed with the link navigation
        window.location.href = event.target.href;

        // Set the image source dynamically
        document.getElementById("productImage").src = imageUrl;
      }
    });
  }
</script>

<%-include('../partials/admin_footer')%>